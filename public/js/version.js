// Generated by LiveScript 1.2.0
(function(){
  define(['underscore'], function(_){
    var newer, newFirst, firstByVersion, firstByVersionForAll;
    newer = function(a, b){
      var ref$, ref1$;
      if (((ref$ = (ref1$ = a.base) != null ? ref1$.length : void 8) != null ? ref$ : 0) > 0) {
        return _(a.base).any(function(it){
          return it.name === b.name || newer(it, b);
        });
      } else {
        return false;
      }
    };
    newFirst = function(a, b){
      if (a.name === b.name) {
        return 0;
      } else if (newer(a, b)) {
        return -1;
      } else {
        return 1;
      }
    };
    firstByVersion = function(array){
      if (array.length === 0) {
        return null;
      } else if (array.length === 1) {
        return array[0];
      } else {
        return _(array.sort(function(a, b){
          return newFirst(a.version, b.version);
        })).head();
      }
    };
    firstByVersionForAll = function(array){
      return _.chain(array).groupBy('id').pairs().map(function(it){
        return firstByVersion(it[1]);
      }).value();
    };
    return {
      firstByVersion: firstByVersion,
      firstByVersionForAll: firstByVersionForAll
    };
  });
}).call(this);
