// Generated by LiveScript 1.2.0
(function(){
  define(['items/item', 'underscore', 'util', 'jquery'], function(its, _, util, $){
    var status, items, item, me, users, friends, friend, postItem, findItem;
    status = function(){
      return {
        items: items().length,
        meta: 307,
        keys: users().length
      };
    };
    items = util.memorize(function(){
      var _items;
      _items = [];
      $.ajax('/items', {
        async: false,
        dataType: 'json'
      }).done(function(it){
        return _items = it;
      });
      return _items;
    });
    item = function(id){
      return _(items()).find(function(it){
        return it.id === id;
      });
    };
    me = function(){
      return users()[0];
    };
    users = util.memorize(function(){
      var _users;
      _users = [];
      $.ajax('/users', {
        async: false,
        dataType: 'json'
      }).done(function(it){
        return _users = it;
      });
      return _users;
    });
    friends = users;
    friend = function(id){
      return _(users()).find(function(it){
        return it.id === id;
      });
    };
    postItem = function(item){
      items.del();
      return $.ajax('/items', {
        async: false,
        type: 'POST',
        data: item,
        dataType: 'json'
      });
    };
    findItem = function(where){
      return _(items()).where(where);
    };
    return {
      status: status,
      items: items,
      item: item,
      me: me,
      friends: friends,
      friend: friend,
      postItem: postItem,
      findItem: findItem
    };
  });
}).call(this);
